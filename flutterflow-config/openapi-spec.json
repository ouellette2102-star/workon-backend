{"openapi":"3.0.0","paths":{"/":{"get":{"operationId":"AppController_getHello","parameters":[],"responses":{"200":{"description":""}},"tags":["Health"]}},"/api/v1/users/me":{"get":{"operationId":"UsersController_getMe","summary":"Get current user profile","parameters":[],"responses":{"200":{"description":"Returns current user profile","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponseDto"}}}},"401":{"description":"Unauthorized"}},"tags":["Users"],"security":[{"bearer":[]}]},"patch":{"operationId":"UsersController_updateMe","summary":"Update current user profile","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateUserProfileDto"}}}},"responses":{"200":{"description":"Profile updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponseDto"}}}},"401":{"description":"Unauthorized"},"404":{"description":"User not found"}},"tags":["Users"],"security":[{"bearer":[]}]},"delete":{"operationId":"UsersController_deleteMe","summary":"Delete current user account (GDPR)","description":"Permanently deletes the current user account. Anonymizes all personal data (email, name, phone) and invalidates all sessions. This action is irreversible.","parameters":[],"responses":{"204":{"description":"Account deleted successfully (no content)"},"401":{"description":"Unauthorized - invalid or missing token"},"404":{"description":"User not found"}},"tags":["Users"],"security":[{"bearer":[]}]}},"/api/v1/users/me/picture":{"post":{"operationId":"UsersController_uploadPicture","summary":"Upload profile picture","description":"Upload a profile picture. Accepts JPEG, PNG, WebP (max 5MB). Replaces existing picture.","parameters":[],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"type":"object","properties":{"file":{"type":"string","format":"binary","description":"Image file (JPEG, PNG, WebP)"}},"required":["file"]}}}},"responses":{"200":{"description":"Profile picture uploaded successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponseDto"}}}},"400":{"description":"Invalid file (wrong format or too large)"},"401":{"description":"Unauthorized"},"404":{"description":"User not found"}},"tags":["Users"],"security":[{"bearer":[]}]}},"/api/v1/users/{id}":{"get":{"operationId":"UsersController_findOne","summary":"Get user by ID (admin or self)","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Returns user profile","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponseDto"}}}},"401":{"description":"Unauthorized"},"404":{"description":"User not found"}},"tags":["Users"],"security":[{"bearer":[]}]}},"/api/v1/auth/register":{"post":{"operationId":"AuthController_register","summary":"Register a new user","description":"Creates a new user account and returns JWT tokens","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterDto"}}}},"responses":{"201":{"description":"User registered successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponseDto"}}}},"400":{"description":"Invalid input data"},"409":{"description":"Email already registered"}},"tags":["Auth"]}},"/api/v1/auth/login":{"post":{"operationId":"AuthController_login","summary":"Login with email/password","description":"Authenticates user and returns JWT tokens (access + refresh)","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginDto"}}}},"responses":{"200":{"description":"Login successful","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponseDto"}}}},"401":{"description":"Invalid credentials"}},"tags":["Auth"]}},"/api/v1/auth/me":{"get":{"operationId":"AuthController_getMe","summary":"Get current authenticated user","description":"Returns current user info from JWT token","parameters":[],"responses":{"200":{"description":"Current user info","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponseDto"}}}},"401":{"description":"Unauthorized"}},"tags":["Auth"],"security":[{"bearer":[]}]}},"/api/v1/auth/refresh":{"post":{"operationId":"AuthController_refresh","summary":"Refresh access token","description":"Exchange refresh token for new access + refresh tokens (rotation)","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenDto"}}}},"responses":{"200":{"description":"Tokens refreshed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenResponseDto"}}}},"401":{"description":"Invalid or expired refresh token"}},"tags":["Auth"]}},"/api/v1/auth/forgot-password":{"post":{"operationId":"AuthController_forgotPassword","summary":"Request password reset","description":"Sends password reset email (DEV: returns token in response)","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgotPasswordDto"}}}},"responses":{"200":{"description":"Reset request processed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgotPasswordResponseDto"}}}}},"tags":["Auth"]}},"/api/v1/auth/reset-password":{"post":{"operationId":"AuthController_resetPassword","summary":"Reset password with token","description":"Validates reset token and updates password","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResetPasswordDto"}}}},"responses":{"200":{"description":"Password reset successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResetPasswordResponseDto"}}}},"400":{"description":"Invalid or expired token"}},"tags":["Auth"]}},"/api/v1/auth/account":{"delete":{"operationId":"AuthController_deleteAccount","summary":"Delete user account (GDPR)","description":"Permanently deletes the user account with GDPR compliance:\n    - Anonymizes all PII (email, name, phone, etc.)\n    - Cancels open missions created by the user\n    - Unassigns the user from pending missions\n    - Invalidates authentication (cannot login after deletion)\n    - Preserves completed/paid missions for audit\n    \n    Requires explicit confirmation: body must contain { \"confirm\": \"DELETE\" }","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeleteAccountDto"}}}},"responses":{"200":{"description":"Account deleted successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeleteAccountResponseDto"}}}},"400":{"description":"Confirmation required or invalid"},"401":{"description":"Unauthorized"},"404":{"description":"Account not found"}},"tags":["Auth"],"security":[{"bearer":[]}]}},"/api/v1/notifications":{"get":{"operationId":"NotificationsController_getNotifications","parameters":[{"name":"unreadOnly","required":true,"in":"query","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"tags":["Notifications"]}},"/api/v1/notifications/unread-count":{"get":{"operationId":"NotificationsController_getUnreadCount","parameters":[],"responses":{"200":{"description":""}},"tags":["Notifications"]}},"/api/v1/notifications/{id}/read":{"patch":{"operationId":"NotificationsController_markAsRead","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"tags":["Notifications"]}},"/api/v1/notifications/read-all":{"patch":{"operationId":"NotificationsController_markAllAsRead","parameters":[],"responses":{"200":{"description":""}},"tags":["Notifications"]}},"/api/v1/notifications/preferences":{"get":{"operationId":"NotificationPreferencesController_getPreferences","summary":"Get all notification preferences for current user","parameters":[],"responses":{"200":{"description":"List of notification preferences"}},"tags":["Notification Preferences"],"security":[{"bearer":[]}]}},"/api/v1/notifications/preferences/{notificationType}":{"get":{"operationId":"NotificationPreferencesController_getPreference","summary":"Get preference for a specific notification type","parameters":[{"name":"notificationType","required":true,"in":"path","description":"Type of notification","schema":{"type":"string","enum":["MISSION_NEW_OFFER","MISSION_OFFER_ACCEPTED","MISSION_STARTED","MISSION_COMPLETED","MISSION_CANCELLED","MESSAGE_NEW","MESSAGE_UNREAD_REMINDER","PAYMENT_RECEIVED","PAYMENT_SENT","PAYMENT_FAILED","PAYOUT_PROCESSED","REVIEW_RECEIVED","REVIEW_REMINDER","ACCOUNT_SECURITY","ACCOUNT_VERIFICATION","BOOKING_REQUEST","BOOKING_CONFIRMED","BOOKING_REMINDER","BOOKING_CANCELLED","MARKETING_PROMO","MARKETING_NEWS"]}}],"responses":{"200":{"description":"Notification preference"}},"tags":["Notification Preferences"],"security":[{"bearer":[]}]},"put":{"operationId":"NotificationPreferencesController_updatePreference","summary":"Update preference for a specific notification type","parameters":[{"name":"notificationType","required":true,"in":"path","description":"Type of notification","schema":{"type":"string","enum":["MISSION_NEW_OFFER","MISSION_OFFER_ACCEPTED","MISSION_STARTED","MISSION_COMPLETED","MISSION_CANCELLED","MESSAGE_NEW","MESSAGE_UNREAD_REMINDER","PAYMENT_RECEIVED","PAYMENT_SENT","PAYMENT_FAILED","PAYOUT_PROCESSED","REVIEW_RECEIVED","REVIEW_REMINDER","ACCOUNT_SECURITY","ACCOUNT_VERIFICATION","BOOKING_REQUEST","BOOKING_CONFIRMED","BOOKING_REMINDER","BOOKING_CANCELLED","MARKETING_PROMO","MARKETING_NEWS"]}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateNotificationPreferenceDto"}}}},"responses":{"200":{"description":"Updated notification preference"}},"tags":["Notification Preferences"],"security":[{"bearer":[]}]}},"/api/v1/notifications/preferences/quiet-hours":{"put":{"operationId":"NotificationPreferencesController_setQuietHours","summary":"Set quiet hours for all notification types","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SetQuietHoursDto"}}}},"responses":{"200":{"description":"Quiet hours updated"}},"tags":["Notification Preferences"],"security":[{"bearer":[]}]}},"/api/v1/notifications/preferences/unsubscribe-marketing":{"post":{"operationId":"NotificationPreferencesController_unsubscribeFromMarketing","summary":"Unsubscribe from all marketing notifications","parameters":[],"responses":{"200":{"description":"Unsubscribed from marketing"}},"tags":["Notification Preferences"],"security":[{"bearer":[]}]}},"/api/v1/notifications/preferences/initialize":{"post":{"operationId":"NotificationPreferencesController_initializeDefaults","summary":"Initialize default preferences for user (called on registration)","parameters":[],"responses":{"200":{"description":"Default preferences initialized"}},"tags":["Notification Preferences"],"security":[{"bearer":[]}]}},"/api/v1/notifications/queue/history":{"get":{"operationId":"NotificationQueueController_getHistory","summary":"Get notification history for current user","parameters":[{"name":"limit","required":false,"in":"query","schema":{"type":"number"}},{"name":"offset","required":false,"in":"query","schema":{"type":"number"}},{"name":"status","required":false,"in":"query","schema":{"enum":["PENDING","PROCESSING","DELIVERED","PARTIAL","FAILED","CANCELLED","EXPIRED"],"type":"string"}},{"name":"type","required":false,"in":"query","schema":{"enum":["MISSION_NEW_OFFER","MISSION_OFFER_ACCEPTED","MISSION_STARTED","MISSION_COMPLETED","MISSION_CANCELLED","MESSAGE_NEW","MESSAGE_UNREAD_REMINDER","PAYMENT_RECEIVED","PAYMENT_SENT","PAYMENT_FAILED","PAYOUT_PROCESSED","REVIEW_RECEIVED","REVIEW_REMINDER","ACCOUNT_SECURITY","ACCOUNT_VERIFICATION","BOOKING_REQUEST","BOOKING_CONFIRMED","BOOKING_REMINDER","BOOKING_CANCELLED","MARKETING_PROMO","MARKETING_NEWS"],"type":"string"}}],"responses":{"200":{"description":"Notification history with pagination"}},"tags":["Notification Queue"],"security":[{"bearer":[]}]}},"/api/v1/notifications/queue/{id}":{"delete":{"operationId":"NotificationQueueController_cancelNotification","summary":"Cancel a pending notification","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Notification cancelled"}},"tags":["Notification Queue"],"security":[{"bearer":[]}]}},"/api/v1/notifications/queue/enqueue":{"post":{"operationId":"NotificationQueueController_queueNotification","summary":"[Admin] Queue a notification for delivery","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/QueueNotificationDto"}}}},"responses":{"201":{"description":"Notification queued"}},"tags":["Notification Queue"],"security":[{"bearer":[]}]}},"/api/v1/notifications/queue/pending":{"get":{"operationId":"NotificationQueueController_getPending","summary":"[Admin] Get pending notifications ready for processing","parameters":[{"name":"limit","required":false,"in":"query","schema":{"type":"number"}},{"name":"priority","required":false,"in":"query","schema":{"enum":["LOW","NORMAL","HIGH","CRITICAL"],"type":"string"}}],"responses":{"200":{"description":"List of pending notifications"}},"tags":["Notification Queue"],"security":[{"bearer":[]}]}},"/api/v1/notifications/queue/stats":{"get":{"operationId":"NotificationQueueController_getStats","summary":"[Admin] Get queue statistics","parameters":[],"responses":{"200":{"description":"Queue statistics"}},"tags":["Notification Queue"],"security":[{"bearer":[]}]}},"/api/v1/notifications/queue/cleanup":{"post":{"operationId":"NotificationQueueController_cleanup","summary":"[Admin] Clean up old notifications","parameters":[{"name":"daysToKeep","required":false,"in":"query","description":"Days to keep (default: 30)","schema":{"type":"number"}}],"responses":{"200":{"description":"Cleanup result"}},"tags":["Notification Queue"],"security":[{"bearer":[]}]}},"/api/v1/devices":{"post":{"operationId":"DevicesController_registerDevice","summary":"Register or update a device","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterDeviceDto"}}}},"responses":{"200":{"description":"Device registered/updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeviceResponseDto"}}}},"401":{"description":"Unauthorized"}},"tags":["devices"],"security":[{"bearer":[]}]}},"/api/v1/devices/me":{"get":{"operationId":"DevicesController_getMyDevices","summary":"Get my devices","parameters":[],"responses":{"200":{"description":"List of user devices","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/DeviceResponseDto"}}}}},"401":{"description":"Unauthorized"}},"tags":["devices"],"security":[{"bearer":[]}]}},"/api/v1/devices/{id}":{"delete":{"operationId":"DevicesController_deleteDevice","summary":"Deactivate a device","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"204":{"description":"Device deactivated"},"401":{"description":"Unauthorized"},"404":{"description":"Device not found"}},"tags":["devices"],"security":[{"bearer":[]}]}},"/api/v1/missions":{"post":{"operationId":"MissionsController_createMission","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateMissionDto"}}}},"responses":{"201":{"description":""}},"tags":["Missions"]}},"/api/v1/missions/mine":{"get":{"operationId":"MissionsController_listEmployerMissions","parameters":[],"responses":{"200":{"description":""}},"tags":["Missions"]}},"/api/v1/missions/worker/mine":{"get":{"operationId":"MissionsController_listWorkerMissions","parameters":[],"responses":{"200":{"description":""}},"tags":["Missions"]}},"/api/v1/missions/available":{"get":{"operationId":"MissionsController_listAvailableMissions","parameters":[],"responses":{"200":{"description":""}},"tags":["Missions"]}},"/api/v1/missions/feed":{"get":{"operationId":"MissionsController_getMissionFeed","parameters":[{"name":"category","required":false,"in":"query","description":"Filtrer par catégorie (slug)","example":"entretien","schema":{"type":"string"}},{"name":"city","required":false,"in":"query","description":"Filtrer par ville","example":"Montréal","schema":{"type":"string"}},{"name":"latitude","required":false,"in":"query","description":"Latitude pour recherche géolocalisée","example":45.5017,"schema":{"minimum":-90,"maximum":90,"type":"number"}},{"name":"longitude","required":false,"in":"query","description":"Longitude pour recherche géolocalisée","example":-73.5673,"schema":{"minimum":-180,"maximum":180,"type":"number"}},{"name":"maxDistance","required":false,"in":"query","description":"Rayon de recherche en kilomètres","example":10,"schema":{"minimum":1,"maximum":100,"default":25,"type":"number"}}],"responses":{"200":{"description":""}},"tags":["Missions"]}},"/api/v1/missions/{id}":{"get":{"operationId":"MissionsController_getMissionById","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"tags":["Missions"]}},"/api/v1/missions/{id}/reserve":{"post":{"operationId":"MissionsController_reserveMission","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"201":{"description":""}},"tags":["Missions"]}},"/api/v1/missions/{id}/status":{"patch":{"operationId":"MissionsController_updateStatus","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateMissionStatusDto"}}}},"responses":{"200":{"description":""}},"tags":["Missions"]}},"/api/v1/compliance/accept":{"post":{"operationId":"ComplianceController_acceptDocument","summary":"Accepter un document légal","description":"\nEnregistre l'acceptation explicite d'un document légal (Terms ou Privacy).\n\n**Important:**\n- Un document = une acceptation séparée\n- La version doit correspondre à la version active\n- Idempotent: une double acceptation retourne succès\n- Traçabilité: IP et UserAgent enregistrés pour audit\n\n**Loi 25 Québec / GDPR:** Consentement explicite, traçable, horodaté.\n    ","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AcceptComplianceDto"}}}},"responses":{"200":{"description":"Consentement enregistré avec succès","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AcceptComplianceResponseDto"}}}},"400":{"description":"Version invalide ou données manquantes","content":{"application/json":{"schema":{"example":{"error":"VERSION_MISMATCH","message":"Version invalide. Version active: 1.0","activeVersion":"1.0","providedVersion":"0.9"}}}}},"401":{"description":"Non authentifié"}},"tags":["Compliance"],"security":[{"JWT":[]}]}},"/api/v1/compliance/status":{"get":{"operationId":"ComplianceController_getStatus","summary":"Vérifier le statut de consentement","description":"\nRetourne le statut de consentement pour l'utilisateur connecté.\n\nInclut:\n- isComplete: true si tous les documents requis sont acceptés\n- documents: détail de chaque document (accepté, version, date)\n- missing: liste des documents non acceptés ou avec version obsolète\n    ","parameters":[],"responses":{"200":{"description":"Statut de consentement","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConsentStatusResponseDto"}}}},"401":{"description":"Non authentifié"}},"tags":["Compliance"],"security":[{"JWT":[]}]}},"/api/v1/compliance/versions":{"get":{"operationId":"ComplianceController_getVersions","summary":"Obtenir les versions actives des documents légaux","description":"\nRetourne les versions actives des documents légaux.\nLe frontend utilise ces versions pour afficher les bons documents\net vérifier si le consentement de l'utilisateur est à jour.\n\n**Public:** Cet endpoint ne nécessite pas d'authentification.\n    ","parameters":[],"responses":{"200":{"description":"Versions actives","content":{"application/json":{"schema":{"example":{"versions":{"TERMS":"1.0","PRIVACY":"1.0"},"updatedAt":"2026-01-15T00:00:00.000Z"}}}}}},"tags":["Compliance"]}},"/api/v1/messages/conversations":{"get":{"operationId":"MessagesController_getConversations","summary":"Get all conversations","description":"Returns all chat threads where the user is involved (as employer or worker). Sorted by most recent message first.","parameters":[],"responses":{"200":{"description":"List of conversations","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ConversationResponseDto"}}}}},"401":{"description":"Unauthorized"}},"tags":["Messages"],"security":[{"bearer":[]}]}},"/api/v1/messages/thread/{missionId}":{"get":{"operationId":"MessagesController_getMessages","summary":"Get messages for a mission","parameters":[{"name":"missionId","required":true,"in":"path","description":"Mission ID","schema":{"type":"string"}}],"responses":{"200":{"description":"List of messages"},"403":{"description":"Access denied"},"404":{"description":"Mission not found"}},"tags":["Messages"],"security":[{"bearer":[]}]}},"/api/v1/messages":{"post":{"operationId":"MessagesController_createMessage","summary":"Send a message","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateMessageDto"}}}},"responses":{"201":{"description":"Message sent"},"400":{"description":"Invalid content or no worker assigned"},"403":{"description":"Access denied"}},"tags":["Messages"],"security":[{"bearer":[]}]}},"/api/v1/messages/read/{missionId}":{"patch":{"operationId":"MessagesController_markAsRead","summary":"Mark messages as read","parameters":[{"name":"missionId","required":true,"in":"path","description":"Mission ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Messages marked as read"}},"tags":["Messages"],"security":[{"bearer":[]}]}},"/api/v1/messages/unread-count":{"get":{"operationId":"MessagesController_getUnreadCount","summary":"Get unread messages count","parameters":[],"responses":{"200":{"description":"Unread count"}},"tags":["Messages"],"security":[{"bearer":[]}]}},"/api/v1/contracts":{"post":{"operationId":"ContractsController_createContract","summary":"Create a contract for a mission","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateContractDto"}}}},"responses":{"201":{"description":"Contract created"},"400":{"description":"Invalid data or contract already exists"},"403":{"description":"Consent required or only employer can create contract"},"404":{"description":"Mission not found"}},"tags":["Contracts"],"security":[{"bearer":[]}]}},"/api/v1/contracts/{id}":{"get":{"operationId":"ContractsController_getContract","summary":"Get a contract by ID","parameters":[{"name":"id","required":true,"in":"path","description":"Contract ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Contract details"},"403":{"description":"Consent required or access denied"},"404":{"description":"Contract not found"}},"tags":["Contracts"],"security":[{"bearer":[]}]}},"/api/v1/contracts/user/me":{"get":{"operationId":"ContractsController_getUserContracts","summary":"Get contracts for current user","parameters":[],"responses":{"200":{"description":"List of contracts"},"403":{"description":"Consent required - user must accept Terms and Privacy"}},"tags":["Contracts"],"security":[{"bearer":[]}]}},"/api/v1/contracts/{id}/status":{"patch":{"operationId":"ContractsController_updateContractStatus","summary":"Update contract status","parameters":[{"name":"id","required":true,"in":"path","description":"Contract ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateContractStatusDto"}}}},"responses":{"200":{"description":"Contract updated"},"400":{"description":"Invalid status transition"},"403":{"description":"Consent required or not authorized for this action"},"404":{"description":"Contract not found"}},"tags":["Contracts"],"security":[{"bearer":[]}]}},"/api/v1/payments/mission/{missionId}/intent":{"post":{"operationId":"PaymentsController_createPaymentIntent","summary":"Create escrow PaymentIntent for a mission","description":"Creates a Stripe PaymentIntent with manual capture (escrow). Funds are authorized but not captured until mission completion. Returns clientSecret for frontend payment confirmation.","parameters":[{"name":"missionId","required":true,"in":"path","description":"Mission ID","example":"mission_123","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreatePaymentIntentDto"}}}},"responses":{"201":{"description":"PaymentIntent created successfully"},"400":{"description":"Invalid amount or Stripe not configured"},"403":{"description":"Consent required - user must accept Terms and Privacy"},"404":{"description":"Mission not found"},"409":{"description":"Payment already captured for this mission"}},"tags":["Payments"],"security":[{"bearer":[]}]}},"/api/v1/payments/mission/{missionId}/capture":{"post":{"operationId":"PaymentsController_capturePayment","summary":"Capture authorized payment","description":"Captures the previously authorized funds for a mission. Call this when the mission is completed and approved. The payment must be in AUTHORIZED status.","parameters":[{"name":"missionId","required":true,"in":"path","description":"Mission ID","example":"mission_123","schema":{"type":"string"}}],"responses":{"200":{"description":"Payment captured successfully"},"400":{"description":"Payment not in capturable state"},"403":{"description":"Consent required - user must accept Terms and Privacy"},"404":{"description":"Payment not found"}},"tags":["Payments"],"security":[{"bearer":[]}]}},"/api/v1/payments/mission/{missionId}/cancel":{"post":{"operationId":"PaymentsController_cancelPayment","summary":"Cancel authorized payment","description":"Cancels a PaymentIntent before capture (releases the hold). Use when mission is cancelled or payment is no longer needed. Cannot cancel after capture.","parameters":[{"name":"missionId","required":true,"in":"path","description":"Mission ID","example":"mission_123","schema":{"type":"string"}}],"responses":{"200":{"description":"Payment cancelled successfully"},"400":{"description":"Payment already captured or cancelled"},"403":{"description":"Consent required - user must accept Terms and Privacy"},"404":{"description":"Payment not found"}},"tags":["Payments"],"security":[{"bearer":[]}]}},"/api/v1/payments/mission/{missionId}/status":{"get":{"operationId":"PaymentsController_getPaymentStatus","summary":"Get payment status for a mission","description":"Returns the current payment status and details for a mission.","parameters":[{"name":"missionId","required":true,"in":"path","description":"Mission ID","example":"mission_123","schema":{"type":"string"}}],"responses":{"200":{"description":"Payment status returned"},"403":{"description":"Consent required - user must accept Terms and Privacy"},"404":{"description":"Payment not found"}},"tags":["Payments"],"security":[{"bearer":[]}]}},"/api/v1/payments/create-intent":{"post":{"operationId":"PaymentsController_createPaymentIntentLegacy","summary":"Create PaymentIntent (legacy)","deprecated":true,"parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreatePaymentIntentDto"}}}},"responses":{"403":{"description":"Consent required - user must accept Terms and Privacy"}},"tags":["Payments"],"security":[{"bearer":[]}]}},"/api/v1/webhooks/stripe":{"post":{"operationId":"WebhooksController_handleStripeWebhook","summary":"Stripe webhook endpoint","description":"Receives and processes Stripe webhook events. Signature is verified using STRIPE_WEBHOOK_SECRET. Supports: payment_intent.amount_capturable_updated, payment_intent.succeeded, payment_intent.canceled, payment_intent.payment_failed. Idempotent via lastStripeEventId.","parameters":[{"name":"stripe-signature","required":true,"in":"header","schema":{"type":"string"}}],"responses":{"200":{"description":"Webhook received and processed"},"400":{"description":"Invalid signature"}},"tags":["Webhooks"]}},"/api/v1/payments/checkout":{"post":{"operationId":"CheckoutController_createCheckout","summary":"Create Checkout Session","description":"\n      Creates a Stripe Checkout Session for paying a completed LocalMission.\n      \n      **Flow:**\n      1. Call this endpoint with the missionId\n      2. Receive checkoutUrl\n      3. Redirect user to checkoutUrl\n      4. Stripe handles the payment UI\n      5. User is redirected to success/cancel URL\n      6. Webhook updates invoice & mission status\n      \n      **Pricing:**\n      - Subtotal: Mission price\n      - Platform fee: 12%\n      - Total: Subtotal + Platform fee\n    ","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateCheckoutDto"}}}},"responses":{"201":{"description":"Checkout session created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CheckoutResponseDto"}}}},"400":{"description":"Mission not in payable state"},"403":{"description":"Consent required or not authorized"},"404":{"description":"Mission not found"},"503":{"description":"Stripe not configured"}},"tags":["Payments"],"security":[{"bearer":[]}]}},"/api/v1/payments/invoice/{id}":{"get":{"operationId":"CheckoutController_getInvoice","summary":"Get invoice details","description":"Returns the invoice details including amounts and status.","parameters":[{"name":"id","required":true,"in":"path","description":"Invoice ID","example":"clxyz456def","schema":{"type":"string"}}],"responses":{"200":{"description":"Invoice details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvoiceResponseDto"}}}},"403":{"description":"Consent required - user must accept Terms and Privacy"},"404":{"description":"Invoice not found"}},"tags":["Payments"],"security":[{"bearer":[]}]}},"/api/v1/payments/preview":{"get":{"operationId":"CheckoutController_previewInvoice","summary":"Preview invoice calculation","description":"Returns the calculated amounts for a given price without creating an invoice.","parameters":[{"name":"priceCents","required":true,"in":"query","description":"Price in cents (e.g., 10000 for $100)","example":10000,"schema":{"type":"number"}}],"responses":{"200":{"description":"Invoice calculation preview","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvoicePreviewDto"}}}}},"tags":["Payments"],"security":[{"bearer":[]}]}},"/api/v1/payments/stripe/connect/onboarding":{"get":{"operationId":"StripeController_createOnboardingLink","summary":"Get Stripe Connect onboarding link","description":"Creates or retrieves a Stripe Connect Express account and returns the onboarding URL. Worker must complete identity verification on Stripe.","parameters":[],"responses":{"200":{"description":"Onboarding URL returned"},"403":{"description":"Only workers can access this endpoint"}},"tags":["Payments - Stripe Connect"],"security":[{"JWT":[]}]}},"/api/v1/payments/stripe/connect/refresh":{"post":{"operationId":"StripeController_refreshOnboardingLink","summary":"Refresh Stripe Connect onboarding link","description":"Use this if the previous onboarding link has expired.","parameters":[],"responses":{"200":{"description":"New onboarding URL returned"}},"tags":["Payments - Stripe Connect"],"security":[{"JWT":[]}]}},"/api/v1/payments/stripe/connect/status":{"get":{"operationId":"StripeController_getOnboardingStatus","summary":"Check Stripe Connect account status","description":"Returns the current onboarding status including charges_enabled and payouts_enabled.","parameters":[],"responses":{"200":{"description":"Account status","content":{"application/json":{"schema":{"example":{"hasAccount":true,"accountId":"acct_xxxxx","onboarded":true,"chargesEnabled":true,"payoutsEnabled":true,"detailsSubmitted":true,"requirementsNeeded":[]}}}}}},"tags":["Payments - Stripe Connect"],"security":[{"JWT":[]}]}},"/api/v1/payments/stripe/connect/intent":{"post":{"operationId":"StripeController_createConnectPaymentIntent","summary":"Create Connect payment intent","description":"Creates a PaymentIntent that automatically transfers funds to the worker after deducting the 12% platform fee.","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreatePaymentIntentDto"}}}},"responses":{"201":{"description":"Payment intent created","content":{"application/json":{"schema":{"example":{"paymentIntentId":"pi_xxxxx","clientSecret":"pi_xxxxx_secret_xxxxx","amount":10000,"currency":"CAD","platformFee":1200,"workerReceives":8800}}}}}},"tags":["Payments - Stripe Connect"],"security":[{"JWT":[]}]}},"/api/v1/payments/stripe/create-intent":{"post":{"operationId":"StripeController_createPaymentIntent","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreatePaymentIntentDto"}}}},"responses":{"201":{"description":""}},"tags":["Payments - Stripe Connect"]}},"/api/v1/payments/stripe/worker/history":{"get":{"operationId":"StripeController_getWorkerPayments","parameters":[],"responses":{"200":{"description":""}},"tags":["Payments - Stripe Connect"]}},"/api/v1/payments/stripe/webhook":{"post":{"operationId":"StripeController_handleWebhook","parameters":[{"name":"stripe-signature","required":true,"in":"header","schema":{"type":"string"}}],"responses":{"201":{"description":""}},"tags":["Payments - Stripe Connect"]}},"/api/v1/admin/reconcile-payments":{"post":{"operationId":"AdminController_reconcilePayments","summary":"Reconcile payment statuses","description":"Admin-only: Sync payment statuses with Stripe for all pending payments.","parameters":[],"responses":{"201":{"description":""}},"tags":["Admin"],"security":[{"bearer":[]}]}},"/api/v1/admin/seed-catalog":{"post":{"operationId":"AdminController_seedCatalog","summary":"Seed catalog data","description":"Seeds categories and skills from JSON files. Idempotent (safe to run multiple times). Requires either: Admin JWT token OR X-Admin-Secret header matching ADMIN_SECRET env var.","parameters":[{"name":"x-admin-secret","required":true,"in":"header","schema":{"type":"string"}},{"name":"X-Admin-Secret","in":"header","description":"Admin secret for CI/CD automation (alternative to JWT)","required":false,"schema":{"type":"string"}}],"responses":{"201":{"description":""}},"tags":["Admin"],"security":[{"bearer":[]}]}},"/api/v1/catalog/categories":{"get":{"operationId":"CatalogController_getCategories","summary":"List all job categories","description":"Returns the complete list of WorkOn job categories (10 categories). Categories are the top-level classification for skills/jobs. Use `includeResidential` to filter categories allowed for residential clients. Each category includes: id, name (FR), nameEn, icon emoji, legalNotes, residentialAllowed. **Public endpoint - no authentication required. Data is legally locked.**","parameters":[{"name":"includeResidential","required":false,"in":"query","description":"Filter categories by residential client eligibility. \"true\" = only residential-allowed, \"false\" = only commercial, \"all\" = no filter.","example":"all","schema":{"enum":["true","false","all"],"type":"string"}}],"responses":{"200":{"description":"Array of job categories sorted alphabetically by name","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CategoryResponseDto"}}}}}},"tags":["Catalog"]}},"/api/v1/catalog/skills":{"get":{"operationId":"CatalogController_getSkills","summary":"List skills with filtering and pagination","description":"Returns the paginated list of WorkOn skills/jobs (90 skills total). Skills are specific job types within categories (e.g., \"Residential Cleaning\" in \"Entretien\"). Each skill includes: id, name (FR), nameEn, categoryId, requiresPermit, proofType. Skills with `requiresPermit: true` require workers to provide proof (e.g., RBQ license). Use filters to narrow down results for category pickers or search autocomplete. **Public endpoint - no authentication required. Data is legally locked.**","parameters":[{"name":"categoryName","required":false,"in":"query","description":"Filter by category name in French (exact match). Use GET /categories to get valid names.","example":"Entretien","schema":{"type":"string"}},{"name":"requiresPermit","required":false,"in":"query","description":"Filter skills requiring official permits/licenses (true/false)","example":true,"schema":{"type":"boolean"}},{"name":"proofType","required":false,"in":"query","description":"Filter by exact proof type required (e.g., \"Licence RBQ\", \"DEP\", \"MAPAQ\")","example":"Licence RBQ","schema":{"type":"string"}},{"name":"q","required":false,"in":"query","description":"Free-text search on skill name (FR) and nameEn. Case-insensitive, partial match.","example":"plomberie","schema":{"type":"string"}},{"name":"page","required":false,"in":"query","description":"Page number (1-based). Default: 1","example":1,"schema":{"minimum":1,"default":1,"type":"number"}},{"name":"pageSize","required":false,"in":"query","description":"Number of items per page. Default: 50, Max: 100","example":50,"schema":{"minimum":1,"maximum":100,"default":50,"type":"number"}},{"name":"sort","required":false,"in":"query","description":"Field to sort by. Default: name","example":"name","schema":{"enum":["name","nameEn","createdAt"],"type":"string"}},{"name":"order","required":false,"in":"query","description":"Sort order. Default: asc","example":"asc","schema":{"enum":["asc","desc"],"type":"string"}}],"responses":{"200":{"description":"Paginated list of skills with metadata (page, total, totalPages)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedSkillsResponseDto"}}}}},"tags":["Catalog"]}},"/api/v1/catalog/health":{"get":{"operationId":"CatalogController_getHealth","summary":"Catalog service health check","description":"Returns aggregated counts for monitoring and dashboard display. Expected values: 10 categories, 90 skills. Use this endpoint to verify catalog data integrity after deployments. **Public endpoint - no authentication required.**","parameters":[],"responses":{"200":{"description":"Health status with category and skill counts","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CatalogHealthResponseDto"}}}}},"tags":["Catalog"]}},"/api/v1/profile":{"get":{"operationId":"ProfileController_getProfile","summary":"Get current user profile (alias for /me)","parameters":[],"responses":{"200":{"description":""}},"tags":["Profiles"],"security":[{"bearer":[]}]}},"/api/v1/profile/me":{"get":{"operationId":"ProfileController_getMe","summary":"Get current user profile","parameters":[],"responses":{"200":{"description":""}},"tags":["Profiles"],"security":[{"bearer":[]}]},"patch":{"operationId":"ProfileController_updateProfile","summary":"Update current user profile","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateProfileDto"}}}},"responses":{"200":{"description":""}},"tags":["Profiles"],"security":[{"bearer":[]}]}},"/api/v1/health":{"get":{"operationId":"HealthController_getHealth","summary":"Health check complet","description":"Retourne le statut de tous les services (DB, Stripe, Storage, SignedUrls). Public, pas d'authentification requise.","parameters":[],"responses":{"200":{"description":"Service en bonne santé ou dégradé","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok","degraded","error"]},"timestamp":{"type":"string","format":"date-time"},"version":{"type":"string","example":"1.0.0"},"environment":{"type":"string","example":"production"},"uptime":{"type":"number","example":3600.5},"checks":{"type":"object","properties":{"database":{"type":"object","properties":{"status":{"type":"string"},"latencyMs":{"type":"number"}}},"stripe":{"type":"object"},"storage":{"type":"object"},"signedUrls":{"type":"object"}}}}}}}}},"tags":["Health"]}},"/api/v1/ready":{"get":{"operationId":"HealthController_getReady","summary":"Detailed readiness probe","description":"Retourne 200 si le service est prêt à recevoir du trafic, 503 sinon. Inclut le statut de tous les services critiques.","parameters":[],"responses":{"200":{"description":"Service prêt"},"503":{"description":"Service non prêt"}},"tags":["Health"]}},"/api/v1/missions-local":{"post":{"operationId":"MissionsLocalController_create","summary":"Create a new mission","description":"Employers and residential clients can create missions","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateMissionDto"}}}},"responses":{"201":{"description":"Mission created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MissionResponseDto"}}}},"401":{"description":"Unauthorized"},"403":{"description":"Only employers and residential clients can create missions"}},"tags":["Missions"],"security":[{"bearer":[]}]}},"/api/v1/missions-local/map":{"get":{"operationId":"MissionsLocalController_findByMap","summary":"Get missions for map view","description":"Returns lightweight mission data for rendering map pins within a bounding box. More efficient than radius-based search for map rendering.","parameters":[{"name":"north","required":true,"in":"query","description":"Northern boundary latitude","example":45.55,"schema":{"minimum":-90,"maximum":90,"type":"number"}},{"name":"south","required":true,"in":"query","description":"Southern boundary latitude","example":45.45,"schema":{"minimum":-90,"maximum":90,"type":"number"}},{"name":"east","required":true,"in":"query","description":"Eastern boundary longitude","example":-73.5,"schema":{"minimum":-180,"maximum":180,"type":"number"}},{"name":"west","required":true,"in":"query","description":"Western boundary longitude","example":-73.7,"schema":{"minimum":-180,"maximum":180,"type":"number"}},{"name":"status","required":false,"in":"query","description":"Filter by status (default: open)","example":"open","schema":{"enum":["open","assigned","in_progress","completed","cancelled"],"type":"string"}},{"name":"category","required":false,"in":"query","description":"Filter by category","example":"plumbing","schema":{"type":"string"}},{"name":"limit","required":false,"in":"query","description":"Max results (default: 200, max: 500)","example":200,"schema":{"minimum":1,"maximum":500,"type":"number"}}],"responses":{"200":{"description":"List of missions within bounding box","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MissionsMapResponseDto"}}}},"400":{"description":"Invalid bounding box parameters"},"401":{"description":"Unauthorized"}},"tags":["Missions"],"security":[{"bearer":[]}]}},"/api/v1/missions-local/nearby":{"get":{"operationId":"MissionsLocalController_findNearby","summary":"Find nearby open missions","description":"Workers can search for open missions near their location","parameters":[{"name":"latitude","required":true,"in":"query","example":45.5017,"description":"Current latitude","schema":{"type":"number"}},{"name":"longitude","required":true,"in":"query","example":-73.5673,"description":"Current longitude","schema":{"type":"number"}},{"name":"radiusKm","required":false,"in":"query","example":10,"description":"Search radius in kilometers","schema":{"minimum":1,"maximum":100,"default":10,"type":"number"}},{"name":"sort","required":false,"in":"query","example":"proximity","description":"Sort order: proximity (default), date, price","schema":{"enum":["proximity","date","price"],"type":"string"}},{"name":"category","required":false,"in":"query","example":"Entretien","description":"Filter by category name","schema":{"type":"string"}},{"name":"query","required":false,"in":"query","example":"plomberie","description":"Search query for title/description","schema":{"type":"string"}}],"responses":{"200":{"description":"List of nearby missions sorted by distance","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/MissionResponseDto"}}}}},"401":{"description":"Unauthorized"},"403":{"description":"Only workers can search for missions"}},"tags":["Missions"],"security":[{"bearer":[]}]}},"/api/v1/missions-local/{id}/accept":{"post":{"operationId":"MissionsLocalController_accept","summary":"Accept a mission","description":"Worker accepts an open mission","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Mission accepted successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MissionResponseDto"}}}},"400":{"description":"Mission not available"},"401":{"description":"Unauthorized"},"403":{"description":"Only workers can accept missions"},"404":{"description":"Mission not found"}},"tags":["Missions"],"security":[{"bearer":[]}]}},"/api/v1/missions-local/{id}/start":{"post":{"operationId":"MissionsLocalController_start","summary":"Start a mission","description":"Worker starts working on an assigned mission","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Mission started successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MissionResponseDto"}}}},"400":{"description":"Mission not in assigned status"},"401":{"description":"Unauthorized"},"403":{"description":"Only assigned worker can start"},"404":{"description":"Mission not found"}},"tags":["Missions"],"security":[{"bearer":[]}]}},"/api/v1/missions-local/{id}/complete":{"post":{"operationId":"MissionsLocalController_complete","summary":"Mark mission as completed","description":"Worker or mission creator marks mission as completed","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Mission completed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MissionResponseDto"}}}},"401":{"description":"Unauthorized"},"403":{"description":"Only assigned worker or creator can complete"},"404":{"description":"Mission not found"}},"tags":["Missions"],"security":[{"bearer":[]}]}},"/api/v1/missions-local/{id}/cancel":{"post":{"operationId":"MissionsLocalController_cancel","summary":"Cancel a mission","description":"Mission creator or admin cancels a mission","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Mission cancelled successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MissionResponseDto"}}}},"401":{"description":"Unauthorized"},"403":{"description":"Only creator or admin can cancel"},"404":{"description":"Mission not found"}},"tags":["Missions"],"security":[{"bearer":[]}]}},"/api/v1/missions-local/my-missions":{"get":{"operationId":"MissionsLocalController_findMyMissions","summary":"Get my created missions","description":"Get missions created by the current user","parameters":[],"responses":{"200":{"description":"List of created missions","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/MissionResponseDto"}}}}}},"tags":["Missions"],"security":[{"bearer":[]}]}},"/api/v1/missions-local/my-assignments":{"get":{"operationId":"MissionsLocalController_findMyAssignments","summary":"Get my assigned missions","description":"Get missions assigned to the current worker","parameters":[],"responses":{"200":{"description":"List of assigned missions","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/MissionResponseDto"}}}}}},"tags":["Missions"],"security":[{"bearer":[]}]}},"/api/v1/missions-local/{id}":{"get":{"operationId":"MissionsLocalController_findOne","summary":"Get mission by ID","description":"Get detailed information about a specific mission","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Mission details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MissionResponseDto"}}}},"404":{"description":"Mission not found"}},"tags":["Missions"],"security":[{"bearer":[]}]}},"/api/v1/messages-local/conversations":{"get":{"operationId":"MessagesLocalController_getConversations","summary":"Get all conversations","description":"Returns all chat threads where the user is involved (as employer or worker). Sorted by most recent message first.","parameters":[],"responses":{"200":{"description":"List of conversations"},"401":{"description":"Unauthorized"}},"tags":["Messages (Local)"],"security":[{"bearer":[]}]}},"/api/v1/messages-local/thread/{missionId}":{"get":{"operationId":"MessagesLocalController_getMessages","summary":"Get messages for a mission","parameters":[{"name":"missionId","required":true,"in":"path","description":"Mission ID","schema":{"type":"string"}}],"responses":{"200":{"description":"List of messages"},"403":{"description":"Access denied"},"404":{"description":"Mission not found"}},"tags":["Messages (Local)"],"security":[{"bearer":[]}]}},"/api/v1/messages-local":{"post":{"operationId":"MessagesLocalController_createMessage","summary":"Send a message","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateLocalMessageDto"}}}},"responses":{"201":{"description":"Message sent"},"400":{"description":"Invalid content or no worker assigned"},"403":{"description":"Access denied"}},"tags":["Messages (Local)"],"security":[{"bearer":[]}]}},"/api/v1/messages-local/read/{missionId}":{"patch":{"operationId":"MessagesLocalController_markAsRead","summary":"Mark messages as read","parameters":[{"name":"missionId","required":true,"in":"path","description":"Mission ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Messages marked as read"}},"tags":["Messages (Local)"],"security":[{"bearer":[]}]}},"/api/v1/messages-local/unread-count":{"get":{"operationId":"MessagesLocalController_getUnreadCount","summary":"Get unread messages count","parameters":[],"responses":{"200":{"description":"Unread count"}},"tags":["Messages (Local)"],"security":[{"bearer":[]}]}},"/api/v1/metrics/prometheus":{"get":{"operationId":"MetricsController_getPrometheusMetrics","summary":"Prometheus metrics endpoint","description":"Returns metrics in Prometheus exposition format","parameters":[],"responses":{"200":{"description":"Prometheus metrics"}},"tags":["Metrics"]}},"/api/v1/metrics/ratio":{"get":{"operationId":"MetricsController_getRatio","summary":"Get worker to employer ratio","description":"Returns the ratio of workers to employers in a region or globally","parameters":[{"name":"region","required":false,"in":"query","example":"Montréal","description":"Region/city to filter by (optional)","schema":{"type":"string"}}],"responses":{"200":{"description":"Ratio metrics","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RatioResponseDto"}}}}},"tags":["Metrics"]}},"/api/v1/metrics/regions":{"get":{"operationId":"MetricsController_getRegions","summary":"Get available regions","description":"Returns list of regions/cities with active users","parameters":[],"responses":{"200":{"description":"List of regions","content":{"application/json":{"schema":{"example":["Montréal","Laval","Québec","Gatineau"]}}}}},"tags":["Metrics"]}},"/api/v1/payments-local/intent":{"post":{"operationId":"PaymentsLocalController_createPaymentIntent","summary":"Create a payment intent","description":"Creates a Stripe PaymentIntent for a completed mission. Requires Stripe to be configured.","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreatePaymentIntentDto"}}}},"responses":{"201":{"description":"PaymentIntent created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaymentIntentResponseDto"}}}},"400":{"description":"Invalid request"},"401":{"description":"Unauthorized"},"404":{"description":"Mission not found"},"503":{"description":"Stripe not configured"}},"tags":["Payments"],"security":[{"bearer":[]}]}},"/api/v1/payments-local/webhook":{"post":{"operationId":"PaymentsLocalController_handleWebhook","summary":"Stripe webhook endpoint","description":"Receives Stripe webhook events for payment processing. Called by Stripe servers.","parameters":[{"name":"stripe-signature","required":true,"in":"header","schema":{"type":"string"}}],"responses":{"200":{"description":"Webhook processed successfully"},"400":{"description":"Invalid webhook signature"}},"tags":["Payments"]}},"/api/v1/missions/{missionId}/photos":{"get":{"operationId":"MissionPhotosController_getPhotos","summary":"Liste des photos d'une mission","description":"Retourne toutes les photos uploadées pour une mission. Accessible par l'employer ou le worker assigné.","parameters":[{"name":"missionId","required":true,"in":"path","description":"ID de la mission","schema":{"type":"string"}}],"responses":{"200":{"description":"Liste des photos","content":{"application/json":{"schema":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"missionId":{"type":"string"},"userId":{"type":"string"},"url":{"type":"string"},"createdAt":{"type":"string","format":"date-time"}}}}}}},"403":{"description":"Accès refusé"},"404":{"description":"Mission introuvable"}},"tags":["Missions"],"security":[{"bearer":[]}]},"post":{"operationId":"MissionPhotosController_uploadPhotos","summary":"Upload photos pour une mission","description":"Upload jusqu'à 10 photos (max 5MB chacune). Formats: JPEG, PNG, WebP. Accessible par l'employer ou le worker assigné.","parameters":[{"name":"missionId","required":true,"in":"path","description":"ID de la mission","schema":{"type":"string"}}],"requestBody":{"required":true,"description":"Fichiers images à uploader","content":{"multipart/form-data":{"schema":{"type":"object","properties":{"files":{"type":"array","items":{"type":"string","format":"binary"},"description":"Jusqu'à 10 fichiers images (JPEG, PNG, WebP)"}},"required":["files"]}}}},"responses":{"201":{"description":"Photos uploadées avec succès","content":{"application/json":{"schema":{"type":"object","properties":{"uploaded":{"type":"number","description":"Nombre de photos uploadées"},"photos":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"missionId":{"type":"string"},"userId":{"type":"string"},"url":{"type":"string"},"createdAt":{"type":"string","format":"date-time"}}}}}}}}},"400":{"description":"Fichier invalide (type/taille)"},"403":{"description":"Accès refusé"},"404":{"description":"Mission introuvable"}},"tags":["Missions"],"security":[{"bearer":[]}]}},"/api/v1/missions/{missionId}/photos/{photoId}":{"delete":{"operationId":"MissionPhotosController_deletePhoto","parameters":[{"name":"missionId","required":true,"in":"path","schema":{"type":"string"}},{"name":"photoId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"tags":["Missions"],"security":[{"bearer":[]}]}},"/api/v1/missions/{missionId}/photos/{photoId}/signed-url":{"get":{"operationId":"MediaController_getSignedUrl","summary":"Obtenir une URL signée pour une photo","description":"Génère une URL temporaire (expiration configurable) pour accéder à une photo de mission. Accessible uniquement par l'employer ou le worker assigné.","parameters":[{"name":"missionId","required":true,"in":"path","description":"ID de la mission","schema":{"type":"string"}},{"name":"photoId","required":true,"in":"path","description":"ID de la photo","schema":{"type":"string"}}],"responses":{"200":{"description":"URL signée générée","content":{"application/json":{"schema":{"type":"object","properties":{"url":{"type":"string","description":"URL signée temporaire","example":"https://api.example.com/api/v1/media/photos/abc123/stream?token=..."},"expiresAt":{"type":"string","format":"date-time","description":"Date d'expiration ISO","example":"2025-01-01T12:05:00.000Z"}}}}}},"403":{"description":"Accès refusé à cette mission"},"404":{"description":"Photo ou mission introuvable"}},"tags":["Media"],"security":[{"bearer":[]}]}},"/api/v1/media/photos/{photoId}/stream":{"get":{"operationId":"MediaController_streamPhoto","summary":"Stream une photo (token signé requis)","description":"Retourne le fichier image. Nécessite un token signé valide (non expiré). Cette route est publique mais protégée par la vérification du token.","parameters":[{"name":"photoId","required":true,"in":"path","description":"ID de la photo","schema":{"type":"string"}},{"name":"token","required":true,"in":"query","description":"Token signé (obtenu via /signed-url)","schema":{"type":"string"}}],"responses":{"200":{"description":"Fichier image (binary)","content":{"image/jpeg":{},"image/png":{},"image/webp":{}}},"401":{"description":"Token manquant ou invalide"},"403":{"description":"Token expiré ou photoId non correspondant"},"404":{"description":"Photo introuvable sur le stockage"}},"tags":["Media"]}},"/api/v1/missions/{missionId}/events":{"get":{"operationId":"MissionEventsController_getMissionEvents","summary":"Événements d'une mission","description":"Retourne le journal des événements (lifecycle) d'une mission. Accessible uniquement par l'employer ou le worker assigné.","parameters":[{"name":"missionId","required":true,"in":"path","description":"ID de la mission","schema":{"type":"string"}},{"name":"cursor","required":false,"in":"query","description":"Curseur pour pagination (ID du dernier event)","example":"clx1234567890","schema":{"type":"string"}},{"name":"limit","required":false,"in":"query","description":"Nombre d'événements à retourner","example":50,"schema":{"minimum":1,"maximum":100,"default":50,"type":"number"}}],"responses":{"200":{"description":"Liste des événements","content":{"application/json":{"schema":{"type":"object","properties":{"events":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","example":"clx1234567890"},"missionId":{"type":"string","example":"mission-uuid"},"type":{"type":"string","enum":["MISSION_CREATED","MISSION_PUBLISHED","MISSION_ACCEPTED","MISSION_STARTED","MISSION_COMPLETED","MISSION_CANCELED","MISSION_EXPIRED","PAYMENT_AUTHORIZED","PAYMENT_CAPTURED","PAYMENT_CANCELED","PHOTO_UPLOADED","OFFER_SUBMITTED","OFFER_ACCEPTED","OFFER_DECLINED"],"example":"MISSION_STARTED"},"actorUserId":{"type":"string","nullable":true},"targetUserId":{"type":"string","nullable":true},"payload":{"type":"object","nullable":true,"example":{"fromStatus":"OPEN","toStatus":"IN_PROGRESS"}},"createdAt":{"type":"string","format":"date-time"}}}},"nextCursor":{"type":"string","nullable":true},"hasMore":{"type":"boolean"}}}}}},"403":{"description":"Accès refusé"},"404":{"description":"Mission introuvable"}},"tags":["Events"],"security":[{"bearer":[]}]}},"/api/v1/me/events":{"get":{"operationId":"MissionEventsController_getMyEvents","summary":"Mon feed d'événements","description":"Retourne les événements ciblant l'utilisateur connecté (notifications futures). Pagination cursor-based.","parameters":[{"name":"cursor","required":false,"in":"query","description":"Curseur pour pagination (ID du dernier event)","example":"clx1234567890","schema":{"type":"string"}},{"name":"limit","required":false,"in":"query","description":"Nombre d'événements à retourner","example":50,"schema":{"minimum":1,"maximum":100,"default":50,"type":"number"}}],"responses":{"200":{"description":"Liste des événements personnels","content":{"application/json":{"schema":{"type":"object","properties":{"events":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"missionId":{"type":"string"},"type":{"type":"string"},"actorUserId":{"type":"string","nullable":true},"targetUserId":{"type":"string","nullable":true},"payload":{"type":"object","nullable":true},"createdAt":{"type":"string","format":"date-time"}}}},"nextCursor":{"type":"string","nullable":true},"hasMore":{"type":"boolean"}}}}}}},"tags":["Events"],"security":[{"bearer":[]}]}},"/api/v1/offers":{"post":{"operationId":"OffersController_create","summary":"Create an offer","description":"Submit an offer for a mission. Workers can only make one offer per mission.","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateOfferDto"}}}},"responses":{"201":{"description":"Offer created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OfferResponseDto"}}}},"400":{"description":"Mission not open or invalid data"},"401":{"description":"Unauthorized"},"403":{"description":"Consent required or cannot offer on your own mission"},"404":{"description":"Mission not found"},"409":{"description":"Already made an offer on this mission"}},"tags":["Offers"],"security":[{"bearer":[]}]},"get":{"operationId":"OffersController_findWithQuery","summary":"Get offers (optional missionId filter)","description":"Returns offers. If missionId query param is provided, returns offers for that mission. Otherwise returns current user offers (same as /mine).","parameters":[{"name":"missionId","required":false,"in":"query","description":"Filter by mission ID","example":"local_1234567890_abc123","schema":{"type":"string"}}],"responses":{"200":{"description":"List of offers","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/OfferResponseDto"}}}}},"401":{"description":"Unauthorized"},"403":{"description":"Consent required"}},"tags":["Offers"],"security":[{"bearer":[]}]}},"/api/v1/offers/mission/{missionId}":{"get":{"operationId":"OffersController_findByMission","summary":"Get offers for a mission","description":"Returns all offers for a specific mission, ordered by creation date (newest first).","parameters":[{"name":"missionId","required":true,"in":"path","description":"Mission ID","example":"local_1234567890_abc123","schema":{"type":"string"}}],"responses":{"200":{"description":"List of offers","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/OfferResponseDto"}}}}},"401":{"description":"Unauthorized"},"403":{"description":"Consent required - user must accept Terms and Privacy"},"404":{"description":"Mission not found"}},"tags":["Offers"],"security":[{"bearer":[]}]}},"/api/v1/offers/{id}/accept":{"patch":{"operationId":"OffersController_accept","summary":"Accept an offer","description":"Accept an offer for your mission. This will decline all other pending offers and assign the worker to the mission.","parameters":[{"name":"id","required":true,"in":"path","description":"Offer ID","example":"offer_1234567890_abc123","schema":{"type":"string"}}],"responses":{"200":{"description":"Offer accepted successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OfferResponseDto"}}}},"400":{"description":"Offer already accepted or mission closed"},"401":{"description":"Unauthorized"},"403":{"description":"Consent required or only mission owner can accept offers"},"404":{"description":"Offer not found"}},"tags":["Offers"],"security":[{"bearer":[]}]}},"/api/v1/offers/mine":{"get":{"operationId":"OffersController_findMine","summary":"Get my offers/applications","description":"Returns all offers made by the current user, with mission details.","parameters":[],"responses":{"200":{"description":"List of user offers with mission details","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/OfferResponseDto"}}}}},"401":{"description":"Unauthorized"},"403":{"description":"Consent required"}},"tags":["Offers"],"security":[{"bearer":[]}]}},"/api/v1/offers/{id}/reject":{"patch":{"operationId":"OffersController_reject","summary":"Reject an offer","description":"Reject an offer for your mission. Only pending offers can be rejected.","parameters":[{"name":"id","required":true,"in":"path","description":"Offer ID","example":"offer_1234567890_abc123","schema":{"type":"string"}}],"responses":{"200":{"description":"Offer rejected successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OfferResponseDto"}}}},"400":{"description":"Offer not pending"},"401":{"description":"Unauthorized"},"403":{"description":"Consent required or only mission owner can reject"},"404":{"description":"Offer not found"}},"tags":["Offers"],"security":[{"bearer":[]}]}},"/api/v1/offers/{id}":{"get":{"operationId":"OffersController_findById","summary":"Get offer by ID","description":"Returns details of a specific offer.","parameters":[{"name":"id","required":true,"in":"path","description":"Offer ID","example":"offer_1234567890_abc123","schema":{"type":"string"}}],"responses":{"200":{"description":"Offer details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OfferResponseDto"}}}},"401":{"description":"Unauthorized"},"403":{"description":"Consent required - user must accept Terms and Privacy"},"404":{"description":"Offer not found"}},"tags":["Offers"],"security":[{"bearer":[]}]}},"/api/v1/reviews/summary":{"get":{"operationId":"ReviewsController_getSummary","summary":"Get rating summary for a user","parameters":[{"name":"userId","required":true,"in":"query","description":"Target user ID","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RatingSummaryDto"}}}}},"tags":["Reviews"],"security":[{"bearer":[]}]}},"/api/v1/reviews":{"get":{"operationId":"ReviewsController_getReviews","summary":"Get reviews for a user","parameters":[{"name":"userId","required":true,"in":"query","description":"Target user ID","schema":{"type":"string"}},{"name":"limit","required":false,"in":"query","description":"Max results","schema":{"type":"string"}},{"name":"offset","required":false,"in":"query","description":"Skip results","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ReviewResponseDto"}}}}}},"tags":["Reviews"],"security":[{"bearer":[]}]},"post":{"operationId":"ReviewsController_create","summary":"Create a review","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateReviewDto"}}}},"responses":{"201":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReviewResponseDto"}}}},"409":{"description":"Review already exists"}},"tags":["Reviews"],"security":[{"bearer":[]}]}},"/api/v1/reviews/{id}":{"get":{"operationId":"ReviewsController_findOne","summary":"Get a review by ID","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReviewResponseDto"}}}},"404":{"description":"Review not found"}},"tags":["Reviews"],"security":[{"bearer":[]}]}},"/api/v1/earnings/summary":{"get":{"operationId":"EarningsController_getSummary","summary":"Get earnings summary","description":"Returns total lifetime earnings, paid amount, pending amount, and available balance for the worker.","parameters":[],"responses":{"200":{"description":"Earnings summary retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EarningsSummaryDto"}}}},"401":{"description":"Unauthorized"}},"tags":["Earnings"],"security":[{"bearer":[]}]}},"/api/v1/earnings/history":{"get":{"operationId":"EarningsController_getHistory","summary":"Get earnings history","description":"Returns paginated list of all earning transactions (completed/paid missions).","parameters":[{"name":"cursor","required":false,"in":"query","description":"Cursor for pagination (last item ID)","example":"local_1705678901234_abc","schema":{"type":"string"}},{"name":"limit","required":false,"in":"query","description":"Number of items to return (default 20, max 100)","example":20,"schema":{"default":20,"type":"number"}}],"responses":{"200":{"description":"Earnings history retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EarningsHistoryResponseDto"}}}},"401":{"description":"Unauthorized"}},"tags":["Earnings"],"security":[{"bearer":[]}]}},"/api/v1/earnings/by-mission/{missionId}":{"get":{"operationId":"EarningsController_getByMission","summary":"Get earnings by mission","description":"Returns detailed earning information for a specific completed/paid mission.","parameters":[{"name":"missionId","required":true,"in":"path","description":"Mission ID","example":"local_1705678901234_abc","schema":{"type":"string"}}],"responses":{"200":{"description":"Mission earnings retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EarningsByMissionResponseDto"}}}},"401":{"description":"Unauthorized"},"404":{"description":"Mission not found or not completed"}},"tags":["Earnings"],"security":[{"bearer":[]}]}},"/api/v1/support/tickets":{"post":{"operationId":"SupportController_createTicket","summary":"Create support ticket","description":"Create a new support ticket. Device context is captured for fraud prevention.","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateSupportTicketDto"}}}},"responses":{"201":{"description":"Ticket created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SupportTicketResponseDto"}}}},"400":{"description":"Invalid input"},"401":{"description":"Unauthorized"}},"tags":["Support"],"security":[{"JWT":[]}]},"get":{"operationId":"SupportController_getMyTickets","summary":"Get my tickets","description":"Get all support tickets created by the authenticated user.","parameters":[{"name":"page","required":false,"in":"query","example":1,"schema":{"type":"number"}},{"name":"limit","required":false,"in":"query","example":20,"schema":{"type":"number"}}],"responses":{"200":{"description":"List of tickets","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TicketListResponseDto"}}}},"401":{"description":"Unauthorized"}},"tags":["Support"],"security":[{"JWT":[]}]}},"/api/v1/support/tickets/{id}":{"get":{"operationId":"SupportController_getTicket","summary":"Get ticket by ID","description":"Get a specific support ticket with all messages.","parameters":[{"name":"id","required":true,"in":"path","description":"Ticket ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Ticket details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SupportTicketResponseDto"}}}},"401":{"description":"Unauthorized"},"403":{"description":"Access denied"},"404":{"description":"Ticket not found"}},"tags":["Support"],"security":[{"JWT":[]}]}},"/api/v1/support/tickets/{id}/messages":{"post":{"operationId":"SupportController_addMessage","summary":"Add message to ticket","description":"Add a new message to an existing support ticket.","parameters":[{"name":"id","required":true,"in":"path","description":"Ticket ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AddTicketMessageDto"}}}},"responses":{"201":{"description":"Message added","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SupportTicketResponseDto"}}}},"400":{"description":"Invalid input"},"401":{"description":"Unauthorized"},"403":{"description":"Access denied or ticket closed"},"404":{"description":"Ticket not found"}},"tags":["Support"],"security":[{"JWT":[]}]}},"/api/v1/support/tickets/{id}/close":{"patch":{"operationId":"SupportController_closeTicket","summary":"Close ticket","description":"Close a support ticket. Only the ticket owner can close it.","parameters":[{"name":"id","required":true,"in":"path","description":"Ticket ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Ticket closed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SupportTicketResponseDto"}}}},"401":{"description":"Unauthorized"},"403":{"description":"Access denied"},"404":{"description":"Ticket not found"}},"tags":["Support"],"security":[{"JWT":[]}]}}},"info":{"title":"WorkOn API","description":"**WorkOn** - Marketplace de services pour travailleurs autonomes.\n\n## Authentification\nLa plupart des endpoints nécessitent un token JWT Bearer.\n\n## Rate Limiting\nLes requêtes sont limitées par IP. Voir headers `X-RateLimit-*`.\n\n## Environnements\n- **Production**: https://api.workon.app\n- **Staging**: https://staging-api.workon.app\n","version":"1.0.0","contact":{"name":"WorkOn Team","url":"https://workon.app","email":"support@workon.app"}},"tags":[{"name":"Health","description":"Endpoints de santé et monitoring (publics)"},{"name":"Auth","description":"Authentification et gestion de session (public → JWT)"},{"name":"Users","description":"Gestion des utilisateurs (JWT)"},{"name":"Profiles","description":"Profils utilisateurs (JWT)"},{"name":"Catalog","description":"Catégories et compétences (public, read-only)"},{"name":"Missions","description":"Gestion des missions (JWT)"},{"name":"Events","description":"Journal d'événements des missions (JWT)"},{"name":"Payments","description":"Paiements Stripe escrow (JWT)"},{"name":"Media","description":"Photos et fichiers (JWT + token signé)"},{"name":"Messages","description":"Messagerie entre parties (JWT)"},{"name":"Contracts","description":"Contrats de mission (JWT)"},{"name":"Notifications","description":"Notifications utilisateur (JWT)"},{"name":"Admin","description":"Administration (JWT + rôle Admin)"},{"name":"Webhooks","description":"Webhooks externes (signature Stripe)"}],"servers":[],"components":{"securitySchemes":{"JWT":{"scheme":"bearer","bearerFormat":"JWT","type":"http","description":"Token JWT obtenu via /auth/login"}},"schemas":{"UserResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"User unique identifier"},"email":{"type":"string","description":"User email address"},"firstName":{"type":"string","description":"User first name"},"lastName":{"type":"string","description":"User last name"},"phone":{"type":"string","description":"User phone number","nullable":true},"city":{"type":"string","description":"User city/region","nullable":true},"pictureUrl":{"type":"string","description":"Profile picture URL","nullable":true},"role":{"type":"string","description":"User role (worker, employer, residential_client)"},"active":{"type":"boolean","description":"Account active status"},"createdAt":{"format":"date-time","type":"string","description":"Account creation date"},"updatedAt":{"format":"date-time","type":"string","description":"Last update date"}},"required":["id","email","firstName","lastName","role","createdAt","updatedAt"]},"UpdateUserProfileDto":{"type":"object","properties":{"firstName":{"type":"string","example":"John","description":"User first name"},"lastName":{"type":"string","example":"Doe","description":"User last name"},"phone":{"type":"string","example":"+1 514 555 0100","description":"User phone number"},"city":{"type":"string","example":"Montréal","description":"User city/region"}}},"RegisterDto":{"type":"object","properties":{"email":{"type":"string","example":"john.doe@example.com","description":"User email address"},"password":{"type":"string","example":"SecurePassword123!","description":"User password (min 8 characters)","minLength":8},"firstName":{"type":"string","example":"John","description":"User first name","default":""},"lastName":{"type":"string","example":"Doe","description":"User last name","default":""},"phone":{"type":"string","example":"+1 514 555 0100","description":"User phone number"},"city":{"type":"string","example":"Montréal","description":"User city/region"},"role":{"type":"string","enum":["worker","employer","residential_client"],"example":"worker","description":"User role in the platform","default":"worker"}},"required":["email","password"]},"AuthResponseDto":{"type":"object","properties":{"accessToken":{"type":"string","description":"JWT access token (use in Authorization: Bearer <token>)","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"refreshToken":{"type":"string","description":"JWT refresh token (use to obtain new access token)","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"user":{"description":"Authenticated user information","allOf":[{"$ref":"#/components/schemas/UserResponseDto"}]}},"required":["accessToken","refreshToken","user"]},"LoginDto":{"type":"object","properties":{"email":{"type":"string","example":"john.doe@example.com","description":"User email address"},"password":{"type":"string","example":"SecurePassword123!","description":"User password"}},"required":["email","password"]},"RefreshTokenDto":{"type":"object","properties":{"refreshToken":{"type":"string","description":"Refresh token received at login","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}},"required":["refreshToken"]},"RefreshTokenResponseDto":{"type":"object","properties":{"accessToken":{"type":"string","description":"New access token","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"refreshToken":{"type":"string","description":"New refresh token (rotated)","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}},"required":["accessToken","refreshToken"]},"ForgotPasswordDto":{"type":"object","properties":{"email":{"type":"string","description":"Email address for password reset","example":"user@example.com"}},"required":["email"]},"ForgotPasswordResponseDto":{"type":"object","properties":{"message":{"type":"string","description":"Success message","example":"If this email exists, a reset link has been sent"},"resetToken":{"type":"string","description":"Reset token (DEV ONLY - not returned in production)","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}},"required":["message"]},"ResetPasswordDto":{"type":"object","properties":{"token":{"type":"string","description":"Reset token received via email","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"newPassword":{"type":"string","description":"New password (min 8 characters)","example":"NewSecureP@ss123","minLength":8}},"required":["token","newPassword"]},"ResetPasswordResponseDto":{"type":"object","properties":{"message":{"type":"string","description":"Success message","example":"Password has been reset successfully"}},"required":["message"]},"DeleteAccountDto":{"type":"object","properties":{"confirm":{"type":"string","description":"Confirmation string - must be exactly \"DELETE\" to proceed","example":"DELETE"}},"required":["confirm"]},"DeleteAccountResponseDto":{"type":"object","properties":{"ok":{"type":"boolean","description":"Whether the operation was successful","example":true},"message":{"type":"string","description":"Success or error message","example":"Votre compte a été supprimé."},"errorCode":{"type":"string","description":"Error code for programmatic handling","example":"CONFIRM_REQUIRED","enum":["CONFIRM_REQUIRED","ACCOUNT_NOT_FOUND","DELETION_FAILED"]}},"required":["ok"]},"UpdateNotificationPreferenceDto":{"type":"object","properties":{"pushEnabled":{"type":"boolean","description":"Enable push notifications"},"emailEnabled":{"type":"boolean","description":"Enable email notifications"},"inAppEnabled":{"type":"boolean","description":"Enable in-app notifications"},"smsEnabled":{"type":"boolean","description":"Enable SMS notifications"},"quietHoursStart":{"type":"object","description":"Quiet hours start time (HH:MM format, 24h)","example":"22:00"},"quietHoursEnd":{"type":"object","description":"Quiet hours end time (HH:MM format, 24h)","example":"08:00"},"timezone":{"type":"string","description":"User timezone","example":"America/Toronto"},"digestEnabled":{"type":"boolean","description":"Enable digest mode (bundle notifications)"},"digestFrequency":{"type":"string","description":"Digest frequency","enum":["IMMEDIATE","HOURLY","DAILY","WEEKLY"]}}},"SetQuietHoursDto":{"type":"object","properties":{"quietHoursStart":{"type":"object","description":"Quiet hours start time (HH:MM format, 24h). Set to null to disable.","example":"22:00"},"quietHoursEnd":{"type":"object","description":"Quiet hours end time (HH:MM format, 24h). Set to null to disable.","example":"08:00"},"timezone":{"type":"string","description":"User timezone for quiet hours calculation","example":"America/Toronto"}}},"QueueNotificationDto":{"type":"object","properties":{"userId":{"type":"string","description":"User ID to send notification to"},"notificationType":{"type":"string","description":"Notification type","enum":["MISSION_NEW_OFFER","MISSION_OFFER_ACCEPTED","MISSION_STARTED","MISSION_COMPLETED","MISSION_CANCELLED","MESSAGE_NEW","MESSAGE_UNREAD_REMINDER","PAYMENT_RECEIVED","PAYMENT_SENT","PAYMENT_FAILED","PAYOUT_PROCESSED","REVIEW_RECEIVED","REVIEW_REMINDER","ACCOUNT_SECURITY","ACCOUNT_VERIFICATION","BOOKING_REQUEST","BOOKING_CONFIRMED","BOOKING_REMINDER","BOOKING_CANCELLED","MARKETING_PROMO","MARKETING_NEWS"]},"title":{"type":"string","description":"Notification title","minLength":1,"maxLength":200},"body":{"type":"string","description":"Notification body","minLength":1,"maxLength":2000},"data":{"type":"object","description":"Additional data payload"},"priority":{"type":"string","description":"Notification priority","enum":["LOW","NORMAL","HIGH","CRITICAL"],"default":"NORMAL"},"scheduledFor":{"type":"string","description":"Schedule delivery for a specific time","example":"2026-01-20T10:00:00Z"},"correlationId":{"type":"string","description":"Correlation ID for tracking"},"idempotencyKey":{"type":"string","description":"Idempotency key to prevent duplicates"}},"required":["userId","notificationType","title","body"]},"RegisterDeviceDto":{"type":"object","properties":{"deviceId":{"type":"string","description":"Unique device identifier (vendor ID, IDFV, etc.)","example":"device_abc123xyz"},"platform":{"type":"string","description":"Device platform","enum":["ios","android","web"],"example":"ios"},"pushToken":{"type":"string","description":"Push notification token (FCM/APNs)","example":"fcm_token_abc123..."},"appVersion":{"type":"string","description":"App version string","example":"1.2.3"}},"required":["deviceId","platform"]},"DeviceResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Device record ID (UUID)"},"userId":{"type":"string","description":"User ID who owns this device"},"deviceId":{"type":"string","description":"Unique device identifier"},"platform":{"type":"string","description":"Platform: ios, android, web"},"pushToken":{"type":"string","description":"Push notification token"},"appVersion":{"type":"string","description":"App version"},"active":{"type":"boolean","description":"Whether device is active"},"lastSeenAt":{"format":"date-time","type":"string","description":"Last activity timestamp"},"createdAt":{"format":"date-time","type":"string","description":"Creation timestamp"}},"required":["id","userId","deviceId","platform","active","lastSeenAt","createdAt"]},"CreateMissionDto":{"type":"object","properties":{"title":{"type":"string","example":"Déneigement entrée résidentielle","description":"Mission title"},"description":{"type":"string","example":"Besoin de déneiger une entrée de 20 mètres","description":"Detailed mission description"},"category":{"type":"string","example":"snow_removal","description":"Mission category","enum":["cleaning","snow_removal","moving","handyman","gardening","painting","delivery","other"]},"price":{"type":"number","example":75,"description":"Mission price in CAD","minimum":0},"latitude":{"type":"number","example":45.5017,"description":"Mission latitude"},"longitude":{"type":"number","example":-73.5673,"description":"Mission longitude"},"city":{"type":"string","example":"Montréal","description":"City/region"},"address":{"type":"string","example":"123 rue Example","description":"Full address (optional)"}},"required":["title","description","category","price","latitude","longitude","city"]},"MissionStatus":{"type":"string","enum":["DRAFT","OPEN","MATCHED","IN_PROGRESS","COMPLETED","CANCELLED"]},"UpdateMissionStatusDto":{"type":"object","properties":{"status":{"description":"Nouveau statut de la mission","example":"IN_PROGRESS","$ref":"#/components/schemas/MissionStatus"}},"required":["status"]},"AcceptComplianceDto":{"type":"object","properties":{"documentType":{"type":"string","enum":["TERMS","PRIVACY"],"description":"Type de document légal à accepter","example":"TERMS"},"version":{"type":"string","description":"Version du document accepté (doit correspondre à la version active)","example":"1.0"}},"required":["documentType","version"]},"AcceptComplianceResponseDto":{"type":"object","properties":{"accepted":{"type":"boolean","example":true},"documentType":{"type":"string","example":"TERMS"},"version":{"type":"string","example":"1.0"},"acceptedAt":{"type":"string","example":"2026-01-15T12:00:00.000Z"}},"required":["accepted","documentType","version","acceptedAt"]},"ConsentStatusResponseDto":{"type":"object","properties":{"isComplete":{"type":"boolean","example":true,"description":"True si tous les documents requis sont acceptés avec la version active"},"documents":{"type":"object","example":{"TERMS":{"accepted":true,"version":"1.0","acceptedAt":"2026-01-15T12:00:00.000Z"},"PRIVACY":{"accepted":false,"version":null,"acceptedAt":null}}},"missing":{"example":["PRIVACY"],"description":"Liste des documents manquants ou avec version obsolète","type":"array","items":{"type":"string"}}},"required":["isComplete","documents","missing"]},"ConversationResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Conversation ID (same as missionId)","example":"mission_abc123"},"missionId":{"type":"string","description":"Mission ID this conversation is about","example":"mission_abc123"},"missionTitle":{"type":"string","description":"Mission title","example":"Déneigement entrée"},"participantName":{"type":"string","description":"Name of the other participant","example":"Jean Dupont"},"participantAvatar":{"type":"string","description":"Avatar URL of the other participant (optional)","example":"https://example.com/avatar.jpg"},"lastMessage":{"type":"string","description":"Last message content preview","example":"Bonjour, je suis disponible demain."},"lastMessageAt":{"type":"string","description":"Timestamp of the last message","example":"2024-01-15T10:30:00.000Z"},"unreadCount":{"type":"number","description":"Number of unread messages in this conversation","example":2},"myRole":{"type":"string","description":"Current user role in this conversation","example":"EMPLOYER","enum":["EMPLOYER","WORKER"]}},"required":["id","missionId","missionTitle","participantName","lastMessage","lastMessageAt","unreadCount","myRole"]},"CreateMessageDto":{"type":"object","properties":{"missionId":{"type":"string","description":"Mission ID","example":"mission_123456789"},"content":{"type":"string","description":"Message content","example":"Bonjour, je suis disponible pour cette mission.","maxLength":2000}},"required":["missionId","content"]},"CreateContractDto":{"type":"object","properties":{"missionId":{"type":"string","description":"Mission ID","example":"mission_123456789"},"amount":{"type":"number","description":"Total amount for the contract","example":500,"minimum":0},"hourlyRate":{"type":"number","description":"Hourly rate (if applicable)","example":25},"startAt":{"type":"string","description":"Contract start date (ISO 8601)","example":"2025-01-15T09:00:00.000Z"},"endAt":{"type":"string","description":"Contract end date (ISO 8601)","example":"2025-01-15T17:00:00.000Z"}},"required":["missionId","amount"]},"UpdateContractStatusDto":{"type":"object","properties":{"status":{"type":"string","description":"New contract status","enum":["DRAFT","PENDING","ACCEPTED","REJECTED","COMPLETED","CANCELLED"],"example":"ACCEPTED"}},"required":["status"]},"CreatePaymentIntentDto":{"type":"object","properties":{"missionId":{"type":"string","example":"cly_mission123","description":"Mission ID to create payment for"}},"required":["missionId"]},"CreateCheckoutDto":{"type":"object","properties":{"missionId":{"type":"string","description":"ID of the LocalMission to pay for","example":"clxyz123abc"}},"required":["missionId"]},"CheckoutResponseDto":{"type":"object","properties":{"invoiceId":{"type":"string","description":"Invoice ID for tracking","example":"clxyz456def"},"checkoutUrl":{"type":"string","description":"Stripe Checkout URL - redirect user here","example":"https://checkout.stripe.com/c/pay/cs_test_xxx"},"sessionId":{"type":"string","description":"Stripe Session ID","example":"cs_test_xxx"}},"required":["invoiceId","checkoutUrl","sessionId"]},"InvoiceResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Invoice ID","example":"clxyz456def"},"missionId":{"type":"object","description":"Mission ID","example":"clxyz123abc","nullable":true},"subtotal":{"type":"number","description":"Subtotal (service price)","example":100},"platformFee":{"type":"number","description":"Platform fee (WorkOn)","example":12},"taxes":{"type":"number","description":"Taxes (if applicable)","example":0},"total":{"type":"number","description":"Total amount to pay","example":112},"currency":{"type":"string","description":"Currency","example":"CAD"},"status":{"type":"string","description":"Invoice status","enum":["PENDING","PROCESSING","PAID","FAILED","CANCELLED","REFUNDED"],"example":"PENDING"},"description":{"type":"object","description":"Invoice description","nullable":true},"paidAt":{"type":"object","description":"Payment date (if paid)","nullable":true},"createdAt":{"format":"date-time","type":"string","description":"Creation date"}},"required":["id","missionId","subtotal","platformFee","taxes","total","currency","status","createdAt"]},"InvoicePreviewDto":{"type":"object","properties":{"subtotal":{"type":"number","description":"Subtotal (service price) in dollars","example":100},"platformFee":{"type":"number","description":"Platform fee (WorkOn) in dollars","example":12},"platformFeePercent":{"type":"number","description":"Platform fee percentage","example":12},"taxes":{"type":"number","description":"Taxes in dollars","example":0},"total":{"type":"number","description":"Total amount in dollars","example":112},"currency":{"type":"string","description":"Currency","example":"CAD"}},"required":["subtotal","platformFee","platformFeePercent","taxes","total","currency"]},"CategoryResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Unique category identifier","example":"cat_123456789_abc"},"name":{"type":"string","description":"Category name in French (official)","example":"Entretien"},"nameEn":{"type":"object","description":"Category name in English (for i18n)","example":"Cleaning","nullable":true},"icon":{"type":"object","description":"Emoji icon for UI display","example":"🧼","nullable":true},"legalNotes":{"type":"object","description":"Legal notes or restrictions for this category (Quebec regulations)","example":"Certains services peuvent exiger permis/licence","nullable":true},"residentialAllowed":{"type":"boolean","description":"Whether residential clients can request services in this category","example":true},"createdAt":{"format":"date-time","type":"string","description":"Category creation timestamp (ISO 8601)","example":"2024-01-01T00:00:00.000Z"}},"required":["id","name","residentialAllowed","createdAt"]},"CategorySummaryDto":{"type":"object","properties":{"id":{"type":"string","description":"Unique category identifier","example":"cat_123456789_abc"},"name":{"type":"string","description":"Category name in French","example":"Entretien"},"nameEn":{"type":"object","description":"Category name in English","example":"Cleaning","nullable":true},"icon":{"type":"object","description":"Emoji icon for UI display","example":"🧼","nullable":true},"residentialAllowed":{"type":"boolean","description":"Whether residential clients can request services in this category","example":true}},"required":["id","name","residentialAllowed"]},"SkillResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Unique skill identifier","example":"skill_123456789_abc"},"name":{"type":"string","description":"Skill name in French (official)","example":"Entretien ménager résidentiel"},"nameEn":{"type":"object","description":"Skill name in English (for i18n)","example":"Residential Cleaning","nullable":true},"categoryId":{"type":"string","description":"Parent category identifier (foreign key)","example":"cat_123456789_abc"},"requiresPermit":{"type":"boolean","description":"Whether this skill requires an official permit/license (e.g., RBQ)","example":false},"proofType":{"type":"object","description":"Type of proof required if requiresPermit is true (e.g., \"Licence RBQ\", \"DEP\", \"MAPAQ\")","example":null,"nullable":true},"createdAt":{"format":"date-time","type":"string","description":"Skill creation timestamp (ISO 8601)","example":"2024-01-01T00:00:00.000Z"},"category":{"description":"Embedded parent category details (always included)","allOf":[{"$ref":"#/components/schemas/CategorySummaryDto"}]}},"required":["id","name","categoryId","requiresPermit","createdAt"]},"PaginationMetaDto":{"type":"object","properties":{"page":{"type":"number","description":"Current page number (1-based)","example":1},"pageSize":{"type":"number","description":"Number of items per page","example":50},"total":{"type":"number","description":"Total number of items matching the query","example":90},"totalPages":{"type":"number","description":"Total number of pages available","example":2}},"required":["page","pageSize","total","totalPages"]},"PaginatedSkillsResponseDto":{"type":"object","properties":{"data":{"description":"Array of skills for the current page","type":"array","items":{"$ref":"#/components/schemas/SkillResponseDto"}},"meta":{"description":"Pagination metadata","allOf":[{"$ref":"#/components/schemas/PaginationMetaDto"}]}},"required":["data","meta"]},"CatalogHealthResponseDto":{"type":"object","properties":{"categoriesCount":{"type":"number","description":"Total number of categories in the database (expected: 10)","example":10},"skillsCount":{"type":"number","description":"Total number of skills in the database (expected: 90)","example":90},"timestamp":{"type":"string","description":"Timestamp of this health check (ISO 8601)","example":"2024-01-01T00:00:00.000Z"}},"required":["categoriesCount","skillsCount","timestamp"]},"UpdateProfileDto":{"type":"object","properties":{}},"MissionResponseDto":{"type":"object","properties":{"id":{"type":"string","example":"cly123..."},"title":{"type":"string","example":"Déneigement entrée résidentielle"},"description":{"type":"string","example":"Besoin de déneiger une entrée de 20 mètres"},"category":{"type":"string","example":"snow_removal"},"status":{"type":"string","example":"open","enum":["open","assigned","in_progress","completed","cancelled"]},"price":{"type":"number","example":75},"latitude":{"type":"number","example":45.5017},"longitude":{"type":"number","example":-73.5673},"city":{"type":"string","example":"Montréal"},"address":{"type":"object","example":"123 rue Example","nullable":true},"createdByUserId":{"type":"string","example":"cly_employer123"},"assignedToUserId":{"type":"object","example":"cly_worker456","nullable":true},"distanceKm":{"type":"object","example":2.5,"nullable":true},"createdAt":{"format":"date-time","type":"string","example":"2024-11-18T18:00:00.000Z"},"updatedAt":{"format":"date-time","type":"string","example":"2024-11-18T18:00:00.000Z"}},"required":["id","title","description","category","status","price","latitude","longitude","city","address","createdByUserId","assignedToUserId","distanceKm","createdAt","updatedAt"]},"MissionMapItemDto":{"type":"object","properties":{"id":{"type":"string","description":"Mission ID","example":"lm_1234567890_abc123"},"title":{"type":"string","description":"Mission title","example":"Fix leaking faucet"},"category":{"type":"string","description":"Mission category","example":"plumbing"},"latitude":{"type":"number","description":"Latitude","example":45.5017},"longitude":{"type":"number","description":"Longitude","example":-73.5673},"status":{"type":"string","description":"Mission status","example":"open"},"price":{"type":"number","description":"Price/Rate in CAD","example":150},"city":{"type":"string","description":"City name","example":"Montreal"},"createdAt":{"format":"date-time","type":"string","description":"Creation timestamp","example":"2024-12-26T12:00:00.000Z"}},"required":["id","title","category","latitude","longitude","status","price","createdAt"]},"MissionsMapResponseDto":{"type":"object","properties":{"missions":{"description":"List of missions within bounding box","type":"array","items":{"$ref":"#/components/schemas/MissionMapItemDto"}},"count":{"type":"number","description":"Total count of missions returned","example":42},"bbox":{"type":"object","description":"Bounding box used for query","example":{"north":45.55,"south":45.45,"east":-73.5,"west":-73.7}}},"required":["missions","count","bbox"]},"CreateLocalMessageDto":{"type":"object","properties":{"missionId":{"type":"string","description":"Mission ID","example":"lm_1234567890_abc123"},"content":{"type":"string","description":"Message content","example":"Bonjour, je suis intéressé par cette mission.","maxLength":2000}},"required":["missionId","content"]},"RatioResponseDto":{"type":"object","properties":{"region":{"type":"object","example":"Montréal","description":"Region name (null if global)","nullable":true},"workers":{"type":"number","example":150,"description":"Number of workers in the region"},"employers":{"type":"number","example":75,"description":"Number of employers in the region"},"residentialClients":{"type":"number","example":25,"description":"Number of residential clients in the region"},"workerToEmployerRatio":{"type":"number","example":2,"description":"Worker to employer ratio"}},"required":["workers","employers","residentialClients","workerToEmployerRatio"]},"PaymentIntentResponseDto":{"type":"object","properties":{"paymentIntentId":{"type":"string","example":"pi_1234567890","description":"Stripe PaymentIntent ID"},"clientSecret":{"type":"string","example":"client_secret_1234567890","description":"Client secret for frontend confirmation"},"amount":{"type":"number","example":7500,"description":"Amount in cents"},"currency":{"type":"string","example":"CAD","description":"Currency code"},"missionId":{"type":"string","example":"cly_mission123","description":"Associated mission ID"}},"required":["paymentIntentId","clientSecret","amount","currency","missionId"]},"CreateOfferDto":{"type":"object","properties":{"missionId":{"type":"string","description":"ID of the mission to make an offer on","example":"local_1234567890_abc123"},"price":{"type":"number","description":"Proposed price for the mission","example":150,"minimum":0},"message":{"type":"string","description":"Optional message to the mission owner","example":"I can complete this task within 2 hours."}},"required":["missionId","price"]},"OfferWorkerDto":{"type":"object","properties":{"id":{"type":"string","example":"local_1234567890_abc123"},"firstName":{"type":"string","example":"John"},"lastName":{"type":"string","example":"Doe"},"city":{"type":"object","example":"Paris","nullable":true}},"required":["id","firstName","lastName"]},"OfferMissionDto":{"type":"object","properties":{"id":{"type":"string","example":"local_1234567890_abc123"},"title":{"type":"string","example":"Réparer robinet"},"description":{"type":"string","example":"Le robinet fuit..."},"category":{"type":"string","example":"plumbing"},"price":{"type":"number","example":150},"city":{"type":"string","example":"Montréal"},"status":{"type":"string","enum":["open","assigned","in_progress","completed","cancelled"]},"createdAt":{"format":"date-time","type":"string","example":"2024-12-28T14:30:00.000Z"}},"required":["id","title","description","category","price","city","status","createdAt"]},"OfferResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Unique offer ID","example":"offer_1234567890_abc123"},"missionId":{"type":"string","description":"Mission ID","example":"local_1234567890_abc123"},"workerId":{"type":"string","description":"Worker ID who made the offer","example":"local_1234567890_abc123"},"price":{"type":"number","description":"Proposed price","example":150},"message":{"type":"object","description":"Optional message","example":"I can start tomorrow.","nullable":true},"status":{"type":"string","description":"Offer status","enum":["PENDING","ACCEPTED","DECLINED"],"example":"PENDING"},"worker":{"description":"Worker details (included in mission offers list)","allOf":[{"$ref":"#/components/schemas/OfferWorkerDto"}]},"mission":{"description":"Mission details (included in my offers list)","allOf":[{"$ref":"#/components/schemas/OfferMissionDto"}]},"createdAt":{"format":"date-time","type":"string","description":"Creation timestamp","example":"2024-12-28T14:30:00.000Z"}},"required":["id","missionId","workerId","price","status","createdAt"]},"RatingSummaryDto":{"type":"object","properties":{"average":{"type":"number","description":"Average rating (1.0-5.0)","example":4.5},"count":{"type":"number","description":"Total number of reviews","example":12},"distribution":{"type":"object","description":"Distribution by rating level","example":{"1":0,"2":1,"3":2,"4":4,"5":5}}},"required":["average","count"]},"ReviewAuthorDto":{"type":"object","properties":{"id":{"type":"string"},"fullName":{"type":"string"},"avatarUrl":{"type":"string"}},"required":["id"]},"ReviewResponseDto":{"type":"object","properties":{"id":{"type":"string"},"rating":{"type":"number"},"comment":{"type":"string"},"createdAt":{"format":"date-time","type":"string"},"authorId":{"type":"string"},"author":{"$ref":"#/components/schemas/ReviewAuthorDto"},"missionId":{"type":"string"}},"required":["id","rating","createdAt"]},"CreateReviewDto":{"type":"object","properties":{"toUserId":{"type":"string","description":"ID of the user being reviewed","example":"user_abc123"},"rating":{"type":"number","description":"Rating from 1 to 5","minimum":1,"maximum":5,"example":5},"missionId":{"type":"string","description":"ID of the mission associated with this review","example":"mission_xyz789"},"comment":{"type":"string","description":"Review comment","maxLength":500,"example":"Excellent travail, très professionnel!"}},"required":["toUserId","rating"]},"EarningsSummaryDto":{"type":"object","properties":{"totalLifetimeGross":{"type":"number","description":"Total lifetime gross earnings (before commission)","example":5000},"totalLifetimeNet":{"type":"number","description":"Total lifetime net earnings (after commission)","example":4250},"totalPaid":{"type":"number","description":"Total amount already paid out to worker","example":3000},"totalPending":{"type":"number","description":"Amount pending (completed missions, not yet paid)","example":1000},"totalAvailable":{"type":"number","description":"Amount available for payout (net, after commission)","example":850},"completedMissionsCount":{"type":"number","description":"Number of completed missions (lifetime)","example":25},"paidMissionsCount":{"type":"number","description":"Number of paid missions (lifetime)","example":20},"commissionRate":{"type":"number","description":"Commission rate applied (0.0 - 1.0)","example":0.15},"currency":{"type":"string","description":"Currency code","example":"CAD"}},"required":["totalLifetimeGross","totalLifetimeNet","totalPaid","totalPending","totalAvailable","completedMissionsCount","paidMissionsCount","commissionRate","currency"]},"EarningTransactionDto":{"type":"object","properties":{"id":{"type":"string","description":"Unique transaction ID (same as mission ID)","example":"local_1705678901234_abc"},"missionId":{"type":"string","description":"Mission ID","example":"local_1705678901234_abc"},"missionTitle":{"type":"string","description":"Mission title","example":"Déneigement entrée"},"clientName":{"type":"string","description":"Client name (employer)","example":"Jean Dupont"},"date":{"type":"string","description":"Date of the transaction (mission completion)","example":"2026-01-15T10:30:00.000Z"},"grossAmount":{"type":"number","description":"Gross amount (before commission)","example":100},"commissionAmount":{"type":"number","description":"Commission amount deducted","example":15},"netAmount":{"type":"number","description":"Net amount (after commission)","example":85},"status":{"type":"string","description":"Transaction status","enum":["pending","available","paid"],"example":"paid"},"paidAt":{"type":"string","description":"Date when amount was paid out (if paid)","example":"2026-01-18T14:00:00.000Z"},"currency":{"type":"string","description":"Currency code","example":"CAD"}},"required":["id","missionId","missionTitle","clientName","date","grossAmount","commissionAmount","netAmount","status","currency"]},"EarningsHistoryResponseDto":{"type":"object","properties":{"transactions":{"description":"List of earning transactions","type":"array","items":{"$ref":"#/components/schemas/EarningTransactionDto"}},"nextCursor":{"type":"object","description":"Cursor for next page (null if no more items)","example":"local_1705678901234_xyz"},"totalCount":{"type":"number","description":"Total count of transactions (for display)","example":50}},"required":["transactions","totalCount"]},"EarningsByMissionResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Unique transaction ID (same as mission ID)","example":"local_1705678901234_abc"},"missionId":{"type":"string","description":"Mission ID","example":"local_1705678901234_abc"},"missionTitle":{"type":"string","description":"Mission title","example":"Déneigement entrée"},"clientName":{"type":"string","description":"Client name (employer)","example":"Jean Dupont"},"date":{"type":"string","description":"Date of the transaction (mission completion)","example":"2026-01-15T10:30:00.000Z"},"grossAmount":{"type":"number","description":"Gross amount (before commission)","example":100},"commissionAmount":{"type":"number","description":"Commission amount deducted","example":15},"netAmount":{"type":"number","description":"Net amount (after commission)","example":85},"status":{"type":"string","description":"Transaction status","enum":["pending","available","paid"],"example":"paid"},"paidAt":{"type":"string","description":"Date when amount was paid out (if paid)","example":"2026-01-18T14:00:00.000Z"},"currency":{"type":"string","description":"Currency code","example":"CAD"},"category":{"type":"string","description":"Mission category","example":"deneigement"},"city":{"type":"string","description":"Mission city","example":"Montréal"},"address":{"type":"string","description":"Mission address","example":"123 Rue Exemple"}},"required":["id","missionId","missionTitle","clientName","date","grossAmount","commissionAmount","netAmount","status","currency","category","city"]},"CreateSupportTicketDto":{"type":"object","properties":{"subject":{"type":"string","description":"Ticket subject","example":"Payment not received for mission","minLength":5,"maxLength":200},"description":{"type":"string","description":"Detailed description of the issue","example":"I completed mission XYZ on January 15th but the payment was not credited to my account.","minLength":20,"maxLength":2000},"category":{"type":"string","description":"Ticket category","enum":["PAYMENT","MISSION","ACCOUNT","TECHNICAL","DISPUTE","OTHER"],"example":"PAYMENT"},"missionId":{"type":"string","description":"Related mission ID (if applicable)","example":"mission_abc123"},"priority":{"type":"string","description":"Ticket priority","enum":["LOW","NORMAL","HIGH","URGENT"],"default":"NORMAL"}},"required":["subject","description","category"]},"TicketMessageResponseDto":{"type":"object","properties":{"id":{"type":"string","example":"msg_abc123"},"senderId":{"type":"string","example":"user_xyz789"},"senderType":{"type":"string","example":"user","enum":["user","admin"]},"content":{"type":"string","example":"Here is my response..."},"attachments":{"example":["https://storage.example.com/file1.jpg"],"type":"array","items":{"type":"string"}},"createdAt":{"type":"string","example":"2026-01-19T10:30:00.000Z"}},"required":["id","senderId","senderType","content","createdAt"]},"SupportTicketResponseDto":{"type":"object","properties":{"id":{"type":"string","example":"ticket_abc123"},"userId":{"type":"string","example":"user_xyz789"},"missionId":{"type":"string","example":"mission_def456"},"subject":{"type":"string","example":"Payment not received"},"description":{"type":"string","example":"Detailed description..."},"category":{"type":"string","example":"PAYMENT","enum":["PAYMENT","MISSION","ACCOUNT","TECHNICAL","DISPUTE","OTHER"]},"priority":{"type":"string","example":"NORMAL","enum":["LOW","NORMAL","HIGH","URGENT"]},"status":{"type":"string","example":"OPEN","enum":["OPEN","IN_PROGRESS","WAITING_USER","WAITING_ADMIN","RESOLVED","CLOSED"]},"assignedTo":{"type":"string","example":"admin_user_id"},"resolvedAt":{"type":"string","example":"2026-01-20T14:00:00.000Z"},"createdAt":{"type":"string","example":"2026-01-19T10:30:00.000Z"},"updatedAt":{"type":"string","example":"2026-01-19T10:30:00.000Z"},"messages":{"type":"array","items":{"$ref":"#/components/schemas/TicketMessageResponseDto"}}},"required":["id","userId","subject","description","category","priority","status","createdAt","updatedAt"]},"TicketListResponseDto":{"type":"object","properties":{"tickets":{"type":"array","items":{"$ref":"#/components/schemas/SupportTicketResponseDto"}},"total":{"type":"number","example":10},"page":{"type":"number","example":1},"limit":{"type":"number","example":20}},"required":["tickets","total","page","limit"]},"AddTicketMessageDto":{"type":"object","properties":{"content":{"type":"string","description":"Message content","example":"Here is additional information about my issue...","minLength":1,"maxLength":2000}},"required":["content"]}}}}